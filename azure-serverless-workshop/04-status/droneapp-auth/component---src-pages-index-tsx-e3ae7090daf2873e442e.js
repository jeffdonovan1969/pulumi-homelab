(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{190:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(315),i=n(316),c=n(337),l=n(334),u=n(327),s=n(332),d=n(220),m=n(295),p="undefined"==typeof window?null:n(262),f={login:p?p.handleUserLogin:function(){},isLoggedIn:p?p.isUserLoggedIn:function(){return!1},getUserName:p?p.userName:function(){return""},logout:p?p.handleUserLogout:function(){},handleLoginCallback:p?p.handleAdalCallback:function(){},acquireTokenForAPI:p?p.handleAuthBearerRequest:function(e){}},g=(n(30),n(31),n(13),n(51),n(268)),h=n.n(g),E=n(326),b=n(323),k=n(207),y=n(294),v=(n(23),n(330)),A=n(245),I=n(333),S=function(){var e={sectionStack:{childrenGap:10},spinnerStack:{childrenGap:20}};return a.a.createElement(u.a,{tokens:e.sectionStack},a.a.createElement(u.a,Object.assign({},{horizontal:!0,verticalAlign:"center"},{tokens:e.spinnerStack}),a.a.createElement(I.a,null,"Loading..."),a.a.createElement(v.a,{size:A.a.medium})))},w=n(232);var C=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this)._apiCfg=Object(w.b)(),n.fetchDroneStatusById=function(e){f.acquireTokenForAPI(function(t,r){t?n.handleRequestError(t):(n.setState({loading:!0}),h.a.get(n.getApiResourceUrl(e),{headers:{Authorization:"Bearer "+r,Accept:"application/json"}}).then(function(e){var t=e.data,r=[];Object.keys(t).forEach(function(e,n){r.push({key:n,property:e,value:t[e]})}),n.setState({loading:!1,items:r,error:!1})}).catch(function(e){n.handleRequestError(e)}))})},n.handleRequestError=function(e){n.setState({loading:!1,error:e})},n.getApiResourceUrl=function(e){return""+n._apiCfg.url+e},n._columns=[{key:"column1",name:"Property",fieldName:"property",minWidth:100,maxWidth:200,isResizable:!0},{key:"column2",name:"Value",fieldName:"value",minWidth:100,maxWidth:200,isResizable:!0}],n.state={items:[],loading:!1,error:!1},n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.render=function(){var e=this,t=this.state,n=t.items,r=t.error;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"ms-SearchBoxExample"},a.a.createElement(E.a,{placeholder:"enter drone Id",onSearch:function(t){return e.fetchDroneStatusById(t)}})),this.state.loading?a.a.createElement(S,null):n&&!r?a.a.createElement(b.a,{checkboxVisibility:k.a.hidden,items:n,columns:this._columns,selectionMode:y.b.none,layoutMode:k.e.justified,selectionPreservedOnEmptyClick:!0}):a.a.createElement("p",null,"Error getting drone status"))},r}(a.a.Component);function L(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.d(t,"LoginActionButton",function(){return N}),n.d(t,"RestrictedContent",function(){return O}),Object(m.a)();var _=Object(o.a)()({loginActionButton:["ms-BasicButtonsExample",{selectors:{".ms-Button":{margin:"10px 0"}}}]},{}),N=function(e){function t(){return e.apply(this,arguments)||this}return L(t,e),t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.checked;return a.a.createElement("div",{className:Object(i.a)(_.loginActionButton)},f.isLoggedIn()?a.a.createElement(c.a,{"data-automation-id":"test",iconProps:{iconName:"AddFriend"},allowDisabledFocus:!0,disabled:t,checked:n,onClick:function(e){e.preventDefault(),f.logout()}},"Sign out (",f.getUserName(),")"):a.a.createElement(c.a,{"data-automation-id":"test",iconProps:{iconName:"AddFriend"},allowDisabledFocus:!0,disabled:t,checked:n,onClick:function(e){e.preventDefault(),f.login()}},"Sign in"))},t}(a.a.Component),O=function(e){function t(){return e.apply(this,arguments)||this}return L(t,e),t.prototype.render=function(){return a.a.createElement("div",null,f.isLoggedIn()?a.a.createElement(a.a.Fragment,null,a.a.createElement(C,null)):a.a.createElement(a.a.Fragment,null,"You should ",a.a.createElement(l.a,{onClick:function(e){e.preventDefault(),f.login()}},"Sign in")," to see restricted content!"))},t}(a.a.Component),R={root:{fontSize:d.a.size42}},U={root:{fontSize:d.a.size18}};t.default=function(){return a.a.createElement(u.a,{horizontalAlign:"center",verticalAlign:"center",verticalFill:!0,styles:{root:{width:"960px",margin:"0 auto",textAlign:"center",color:"#605e5c"}},gap:15},f.handleLoginCallback(),a.a.createElement(u.a.Item,{align:"end"},a.a.createElement(N,null)),a.a.createElement(u.a.Item,{align:"start"},a.a.createElement(s.a,{styles:R},"Welcome to Fabrikam Drone Status App")),a.a.createElement(u.a.Item,{align:"start"},a.a.createElement(s.a,{styles:U},"This sample demonstrates how to authenticate a serverless API.")),a.a.createElement(u.a.Item,{align:"start"},a.a.createElement(O,null)))}},232:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=function(){return{apiId:"[APP_ID]",clientId:"[CLIENT_ID]",instance:"https://login.microsoftonline.com/",postLogoutRedirectUri:window.location.origin,tenant:"[TENANT_ID]"}},a=function(){return{url:"[API_URL]"}}},262:function(e,t,n){"use strict";n.r(t),n.d(t,"isUserLoggedIn",function(){return c}),n.d(t,"userName",function(){return l}),n.d(t,"handleUserLogin",function(){return u}),n.d(t,"handleUserLogout",function(){return s}),n.d(t,"handleAdalCallback",function(){return d}),n.d(t,"handleAuthBearerRequest",function(){return m});var r=n(232),a=n(263),o=new(n.n(a).a)(Object(r.a)()),i=function(){return o.getCachedUser()},c=function(){return!!i()},l=function(){return i().userName},u=function(){return o.login()},s=function(){return o.logOut()},d=function(){var e=o.isCallback(window.location.hash);o.handleWindowCallback(),e&&!o.getLoginError()&&(window.location=o._getItem(o.CONSTANTS.STORAGE.LOGIN_REQUEST))},m=function(e){o.acquireToken(o.config.apiId,function(t,n){var r;!t&&n||(r="error occurred: "+t,console.log(r)),e(t,n)})}}}]);
//# sourceMappingURL=component---src-pages-index-tsx-e3ae7090daf2873e442e.js.map